<html>
<script src='https://d3js.org/d3.v6.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/geotiff'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js'></script>

<title>Global Rainfall</title>

<header style="font-size: 15pt; color: #42403f; text-align: center;">Hypothesis: Global rainfall is similar from years 2000 and 2010. </header>
<header style="font-size: 12pt; color: #42403f; text-align: left;">Data of rainfall is taken from January, 2000 and January, 2010 by <a href="https://neo.gsfc.nasa.gov/view.php?datasetId=TRMM_3B43M&year=2000">https://neo.gsfc.nasa.gov/</a>. Rainfall data is for the mentioned month and may not be indicitive of wider trends.</header>

<style>
  body {
    background-color: whitesmoke;
    margin: 1em auto;
    margin-left: 30px;
    width: 1600px;
  }
  svg {
    background-color: transparent;
  }
  path.africa {
    fill: whitesmoke;
    stroke: #969696;
    stroke: #000000;
  }
</style>


<body>
    <div id='vis'></div>


<script>
async function renderVis() {
  let tiff = await d3.buffer('https://raw.githubusercontent.com/zuke0000/Data-Visualization/main/2000_Precipiations_720x360.TIFF')
    .then(buffer => GeoTIFF.fromArrayBuffer(buffer));
let image = await tiff.getImage();
let rasters = await image.readRasters();
let values = rasters[0];
let w = image.getWidth(), h = image.getHeight();
let scaling = Math.min(window.innerWidth * .9 / w, window.innerHeight * .3 / h);
let width = w * scaling, height = h * scaling;
let svg = d3.select('#vis').append('svg').attr('width', width).attr('height', height);
let contours = d3.contours().size([w, h]);
let contourData = contours(values);

let colorScale = d3.scaleSequential(d3.extent(values), d3.interpolateBlues);
let path = d3.geoPath();
let elevations = svg.selectAll('.elevations').data(contourData);
elevations.enter().append('path')
    .attr('class', 'elevations')
    .attr('fill', d => colorScale(d.value))
    .attr('stroke', 'black')
    .attr('stroke-width', 0.0)
    .style('opacity', 0.9)
    .attr('d', d => path(d))
    .attr('transform', `scale(${scaling})`)
    svg.append("text").attr("x", (w / 3.45)).attr("y", 25).text("January 2000 Precipitation").style("font-size", "14pt" ).attr("alignment-baseline","middle").style("fill", 'white');

// draw legend
svg = d3.select('#vis').append('svg').attr('width', width).attr('height', height + 100);
let legend = d3.legendColor()
    .scale(colorScale)
    .orient('horizontal')
    .shapeWidth(50)
    .title('Rainfall (m)');
svg.append('g')
    .attr('transform', `translate(10,${height -20})`)
    .call(legend);
}
renderVis();

    </script>



<script>
  async function renderVis() {
    let tiff = await d3.buffer('https://raw.githubusercontent.com/zuke0000/Data-Visualization/main/2010_Precipiations_720x360.TIFF')
      .then(buffer => GeoTIFF.fromArrayBuffer(buffer));
  let image = await tiff.getImage();
  let rasters = await image.readRasters();
  let values = rasters[0];
  let w = image.getWidth(), h = image.getHeight();
  let scaling = Math.min(window.innerWidth * .9 / w, window.innerHeight * .3 / h);
  let width = w * scaling, height = h * scaling;
  let svg = d3.select('#vis').append('svg').attr('width', width).attr('height', height);
  let contours = d3.contours().size([w, h]);
  let contourData = contours(values);
  
  let colorScale = d3.scaleSequential(d3.extent(values), d3.interpolateBlues);
  let path = d3.geoPath();
  let elevations = svg.selectAll('.elevations').data(contourData);
  elevations.enter().append('path')
      .attr('class', 'elevations')
      .attr('fill', d => colorScale(d.value))
      .attr('stroke', 'black')
      .attr('stroke-width', 0.0)
      .style('opacity', 0.9)
      .attr('d', d => path(d))
      .attr('transform', `scale(${scaling})`)
      svg.append("text").attr("x", (w / 3.45)).attr("y", 25).text("January 2010 Precipitation").style("font-size", "14pt" ).attr("alignment-baseline","middle").style("fill", 'white');
  
  // draw legend
  svg = d3.select('#vis').append('svg').attr('width', width).attr('height', height + 100);
  let legend = d3.legendColor()
      .scale(colorScale)
      .orient('horizontal')
      .shapeWidth(50)
      .title('Rainfall (m)');
  svg.append('g')
      .attr('transform', `translate(10,${height -20})`)
      .call(legend);
      
  }
  renderVis();
  
      </script>


  
</body>
</html>